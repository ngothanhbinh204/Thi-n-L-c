// ============ PRODUCT DETAIL PAGE ============
.section-product-detail
	@apply py-10 xl:pt-20 xl:pb-11

	.wrapper
		@apply grid grid-cols-1 lg:grid-cols-12 gap-5 lg:gap-10

	.product-detail-left
		@apply w-full lg:col-span-9

		.product-detail-hero
			@apply flex flex-col justify-between md:grid md:grid-cols-9 md:gap-2 lg:gap-10 mb-10 lg:mb-20

			.product-gallery
				@apply flex flex-col flex-grow md:grid md:grid-cols-[16%_78%] lg:grid-cols-[18%_81%] w-full md:col-span-6

				.gallery-thumbnails
					@apply flex flex-col gap-2 items-center relative
					@apply w-full order-2 md:order-1 mt-4 md:mt-0 md:pr-3.5
					@apply md:overflow-hidden

					@screen md
						height: 0
						min-height: 100%

					.thumb-nav
						@apply rounded-full border border-primary-2
						@apply flex items-center justify-center cursor-pointer
						@apply transition-all duration-300
						@apply flex-shrink-0

						i
							@apply text-xs

						&.swiper-button-disabled
							@apply opacity-30 cursor-not-allowed pointer-events-none

					.thumbs-slider
						@apply w-full flex-1 min-h-0

						.swiper-slide
							@apply w-full cursor-pointer
							height: auto

							.thumbnail-item
								@apply w-full h-full
								@apply border-2 border-transparent
								@apply transition-all duration-300
								@apply overflow-hidden img-ratio ratio:pt-[100_100] rounded-2

								@screen lg
									padding-top: 0 !important
									height: 100% !important

								img
									@apply w-full h-full object-cover
									@apply transition-transform duration-300

								&:hover
									@apply border-primary-2

									img
										@apply scale-110

							&.swiper-slide-thumb-active
								.thumbnail-item
									@apply border-primary-2

				// Main Gallery
				.gallery-main
					@apply w-full order-1 md:order-2

					.swiper-product-gallery
						@apply w-full rounded-4 overflow-hidden border border-utility-100

						.swiper-slide
							@apply h-full

							.img-wrapper
								@apply w-full h-full overflow-hidden img-ratio ratio:pt-[650_650]
								@apply bg-gray-100

								img
									@apply w-full h-full object-cover

			.product-info
				@apply w-full flex flex-col space-y-4 md:col-span-3

				@media (min-width: 768px)
					max-width: r(266px)

				.product-description
					p
						@apply mb-4

						&:last-child
							@apply mb-0

				.btn-primary
					@apply inline-block text-center w-fit

		// ============ ✅ COMPLETELY FIXED TAB STYLES ============
		.tabs-content
			figure,
			img
				@apply w-auto max-w-full h-auto rounded-4 object-cover
				@apply my-6 #{!important}

			// Tab pane visibility
			.tab-pane
				@apply hidden

				&.active
					@apply block

			// ✅ CRITICAL FIX: Wrapper content tab - Loại bỏ conflict
			.wrapper-content-tab
				@apply relative
				overflow: hidden
				// ✅ FIX: KHÔNG set max-height ở đây, để JS control hoàn toàn
				transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1)

				// ✅ Gradient overlay - CHỈ hiện khi collapsed
				&.collapsed
					position: relative

					&::after
						content: ""
						@apply absolute bottom-0 left-0 w-full pointer-events-none
						height: 120px
						background: linear-gradient(to top, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.95) 20%, rgba(255, 255, 255, 0.8) 40%, rgba(255, 255, 255, 0.4) 70%, rgba(255, 255, 255, 0) 100%)
						opacity: 1
						z-index: 1
						transition: opacity 0.3s ease-in-out

				// ✅ KHÔNG collapsed - ẩn gradient
				&.expanded
					&::after
						content: none 

				// Content body
				.tab-content-body
					@apply relative
					z-index: 0

			// ✅ View more button container
			.view-more-container
				@apply transition-all duration-300

				&.hiddend
					@apply opacity-0 invisible
					max-height: 0
					overflow: hidden
					margin-top: 0 !important

				&.show
					@apply opacity-100 visible
					margin-top: 2rem

				.btn-view-more
					@apply transition-all duration-300 hover:text-primary-2 cursor-pointer
					@apply focus:outline-none focus:ring-2 focus:ring-primary-2 focus:ring-offset-2
					@apply rounded-lg px-4 py-2
					@apply select-none
					// Prevent button highlighting
					-webkit-tap-highlight-color: transparent
					-webkit-touch-callout: none
					user-select: none

					i
						@apply transition-transform duration-300 ease-in-out
						display: inline-block // Để transform hoạt động

					// State khi expanded
					&[aria-expanded="true"]
						i
							transform: rotate(180deg)

					&[aria-expanded="false"]
						i
							transform: rotate(0deg)

					// Disable khi đang animate
					&:disabled
						@apply opacity-50 cursor-not-allowed

		// ============ RELATED PRODUCTS ============
		.product-related
			@apply pt-10 lg:pt-20

			h2
				@apply title-36 text-center text-primary-1 mb-5 lg:mb-11 line-clamp-2

			.wrapper-related-products
				@apply relative flex flex-row items-center gap-2 md:gap-4 xl:gap-6

				.btn-relative-prev,
				.btn-relative-next
					@apply flex-shrink-0

				.swiper-related-products
					@apply overflow-hidden
					padding-bottom: r(20px)

					.swiper-wrapper
						@apply overflow-visible

					.swiper-slide
						@apply overflow-visible

						.slide-inner
							@apply p-3 lg:p-3

							.product-card
								@apply w-full bg-white rounded-2 transition-all duration-300
								overflow: hidden
								box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08)

								.product-info
									@apply px-4 py-6 text-center

									.product-title
										@apply body-18 font-bold mb-4
										@apply transition-colors duration-300
										@apply hover:text-primary-2 cursor-pointer

								.product-image
									@apply overflow-hidden
									aspect-ratio: 1 / 1

									img
										@apply w-full h-full object-cover transition-transform duration-300

								&:hover .product-image img
									@apply scale-110

	// ============ RIGHT COLUMN - SIDEBAR ============
	.product-detail-right
		@apply flex flex-col gap-x-5 w-full lg:col-span-3 sticky self-start
		@extend .space-to-header

		.sidebar-widget
			@apply mb-6

			&:last-child
				@apply mb-0

			.widget-title
				@apply title-24 text-primary-1 font-bold mb-3 pb-3
				@apply border-b-2 border-utility-100

			.widget-content
				// Latest Posts
				.post-item
					@apply mb-3 pb-3
					@apply border-b border-utility-100

					&:last-child
						@apply mb-0 pb-0 border-b-0

					p, a
						@apply m-0 text-black
						@apply leading-1.4
						@apply transition-colors duration-300
						@apply hover:text-primary-2 cursor-pointer

				// Services
				.service-item
					@apply mb-4 pb-4
					@apply border-b border-utility-100

					&:last-child
						@apply mb-0 pb-0 border-b-0

					p
						@apply m-0 text-black

	// ============ RESPONSIVE ============
	@media (max-width: 767px)
		.product-detail-left
			@apply w-full

		.product-detail-right
			@apply w-full

		.product-detail-hero
			@apply grid-cols-1 gap-6

			.product-gallery
				@apply flex-col

				.gallery-thumbnails
					@apply flex-row w-full h-auto order-2

					.thumb-nav
						@apply absolute z-10 top-1/2 transform -translate-y-1/2
						@apply w-8 h-8

						&.thumb-prev
							@apply left-2 -rotate-90

						&.thumb-next
							@apply right-2 -rotate-90

					.thumbnails-wrapper
						@apply flex gap-2 overflow-x-auto

						.thumbnail-item
							@apply w-20 mb-0 flex-shrink-0

		.tabs-navigation
			@apply overflow-x-auto

			.tab-btn
				@apply px-4 py-2 text-sm whitespace-nowrap

		.product-related
			.swiper-navigation
				@apply flex-wrap

// ============ ANIMATIONS ============
@keyframes fadeInUp
	from
		opacity: 0
		transform: translateY(20px)
	to
		opacity: 1
		transform: translateY(0)